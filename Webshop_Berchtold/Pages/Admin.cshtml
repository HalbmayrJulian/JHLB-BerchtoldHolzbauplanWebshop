@page
@model Webshop_Berchtold.Pages.AdminModel
@{
    ViewData["Title"] = "Admin Dashboard";
}

<div class="admin-dashboard">
    <!-- Header Section -->
    <div class="admin-header">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="admin-title">
                        <i class="bi bi-speedometer2"></i> Admin Dashboard
                    </h1>
                    <p class="admin-subtitle text-muted">Produkte und Kategorien verwalten</p>
                </div>
            </div>
            <hr class="admin-divider">
        </div>
    </div>

    <!-- Tabs Navigation -->
    <div class="container-fluid">
        <!-- Success Message -->
        @if (TempData["SuccessMessage"] != null)
        {
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                <i class="bi bi-check-circle-fill"></i> @TempData["SuccessMessage"]
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        }

        <ul class="nav nav-tabs admin-tabs" id="adminTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="products-tab" data-bs-toggle="tab" data-bs-target="#products" type="button" role="tab">
                    <i class="bi bi-box"></i> Produkte
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="categories-tab" data-bs-toggle="tab" data-bs-target="#categories" type="button" role="tab">
                    <i class="bi bi-grid-3x3"></i> Kategorien
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content admin-tab-content" id="adminTabsContent">
            <!-- Products Tab -->
            <div class="tab-pane fade show active" id="products" role="tabpanel">
                <div class="admin-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="section-title">
                            <i class="bi bi-box"></i> Produktverwaltung
                        </h2>
                        <a asp-page="/Admin/CreateProduct" class="btn btn-success">
                            <i class="bi bi-plus-circle"></i> Neues Produkt
                        </a>
                    </div>

                    <div class="table-responsive">
                        <table class="table admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Kategorie</th>
                                    <th>Preis</th>
                                    <th>Anzahl</th>
                                    <th>Verfügbar</th>
                                    <th>Aktionen</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var product in Model.Products)
                                {
                                    <tr>
                                        <td>@product.Id</td>
                                        <td>@product.Name</td>
                                        <td>@(product.Kategorie?.Name ?? "-")</td>
                                        <td>€@product.Preis.ToString("F2")</td>
                                        <td>@product.Anzahl</td>
                                        <td>
                                            @if (product.IstVerfuegbar)
                                            {
                                                <span class="badge bg-success">
                                                    <i class="bi bi-check-circle"></i> Ja
                                                </span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-secondary">
                                                    <i class="bi bi-x-circle"></i> Nein
                                                </span>
                                            }
                                        </td>
                                        <td>
                                            <div class="action-buttons">
                                                <a asp-page="/Admin/EditProduct" asp-route-id="@product.Id" 
                                                   class="btn btn-sm btn-warning" title="Bearbeiten">
                                                    <i class="bi bi-pencil"></i>
                                                </a>
                                                <button class="btn btn-sm btn-danger" title="Löschen">
                                                    <i class="bi bi-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Categories Tab -->
            <div class="tab-pane fade" id="categories" role="tabpanel">
                <div class="admin-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="section-title">
                            <i class="bi bi-grid-3x3"></i> Kategorieverwaltung
                        </h2>
                        <a asp-page="/Admin/ManageCategories" class="btn btn-success">
                            <i class="bi bi-plus-circle"></i> Kategorien verwalten
                        </a>
                    </div>

                    <div class="table-responsive">
                        <table class="table admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Beschreibung</th>
                                    <th>Anzahl Produkte</th>
                                    <th>Aktionen</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var category in Model.Categories)
                                {
                                    <tr>
                                        <td>@category.Id</td>
                                        <td>@category.Name</td>
                                        <td>@(category.Beschreibung ?? "-")</td>
                                        <td>
                                            <span class="badge bg-secondary">@category.Products.Count</span>
                                        </td>
                                        <td>
                                            <div class="action-buttons">
                                                <a asp-page="/Admin/ManageCategories" asp-route-editId="@category.Id" 
                                                   class="btn btn-sm btn-warning" title="Bearbeiten">
                                                    <i class="bi bi-pencil"></i>
                                                </a>
                                            </div>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="alert alert-info mt-3">
                        <i class="bi bi-info-circle"></i> 
                        Verwenden Sie "Kategorien verwalten", um Kategorien zu erstellen, zu bearbeiten oder zu löschen.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
