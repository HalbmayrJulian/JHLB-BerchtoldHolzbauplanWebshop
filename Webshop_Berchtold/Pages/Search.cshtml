@page
@using Microsoft.AspNetCore.Identity
@using Webshop_Berchtold.Models
@inject SignInManager<User> SignInManager
@model SearchModel
@{
    ViewData["Title"] = "Suchergebnisse";
}

<div class="container mt-4">
    @if (!string.IsNullOrWhiteSpace(Model.Query))
    {
        <div class="mb-4">
            <h2>Suchergebnisse für "@Model.Query"</h2>
            <p class="text-muted">@Model.Products.Count Produkt(e) gefunden</p>
        </div>

        @if (Model.Products.Any())
        {
            <div class="row">
                @foreach (var product in Model.Products)
                {
                    var productIcon = !string.IsNullOrEmpty(product.IconClass) ? product.IconClass : "bi-box";
                    var productUrl = $"/ProductDetail?id={product.Id}";
                    
                    <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                        <div class="card product-card h-100">
                            <a href="@productUrl" class="text-decoration-none text-dark">
                                <div class="product-image bg-light d-flex align-items-center justify-content-center">
                                    @if (!string.IsNullOrEmpty(product.BildUrl))
                                    {
                                        <img src="@product.BildUrl" alt="@product.Name" class="img-fluid" />
                                    }
                                    else
                                    {
                                        <i class="@productIcon" style="font-size: 3rem; color: var(--color-medium-gray);"></i>
                                    }
                                </div>
                                <div class="card-body">
                                    <h5 class="card-title product-title">@product.Name</h5>
                                    <p class="card-text text-muted">@product.Beschreibung</p>
                                    @if (product.Kategorie != null)
                                    {
                                        <p class="text-success small mb-2">
                                            <i class="bi bi-tag"></i> @product.Kategorie.Name
                                        </p>
                                    }
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="product-price">€@product.Preis.ToString("N2")</span>
                                        <small class="text-muted">@product.Einheit</small>
                                    </div>
                                </div>
                            </a>
                            <div class="card-footer">
                                <a href="@productUrl" class="btn btn-primary w-100">
                                    <i class="bi bi-eye"></i> Details ansehen
                                </a>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="alert alert-info">
                <i class="bi bi-info-circle"></i> 
                Keine Produkte gefunden für "@Model.Query". Versuchen Sie es mit anderen Suchbegriffen.
            </div>
        }
    }
    else
    {
        <div class="text-center py-5">
            <i class="bi bi-search" style="font-size: 4rem; color: var(--color-light-gray);"></i>
            <h3 class="mt-3">Geben Sie einen Suchbegriff ein</h3>
            <p class="text-muted">Suchen Sie nach Produkten, Kategorien oder Beschreibungen</p>
        </div>
    }
</div>
